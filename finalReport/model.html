<!DOCTYPE HTML>
<!--
	Future Imperfect by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
	https://html5up.net/future-imperfect
-->
<html>
	<head>
		<title>Data Science Final Project</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">
				<!-- Header -->
					<header id="header">
						<h1><a href="#">期末報告 Group 1</a></h1>
						<nav class="links">
							<ul>
								<li><a href="index.html">背景介紹(Backgroud)</a></li>
								<li><a href="eda.html">探索性資料分析(EDA)</a></li>
								<li><a href="feature.html">特徵提取(Feature extraction)</a></li>
								<li><a href="model.html" class="selected">建立模組(Modeling)</a></li>
								<li><a href="demo.html">實際演練(Demo)</a></li>
								<li><a href="reference.html">參考資料(Reference)</a></li>
							</ul>
						</nav>
					</header>
				<!-- Main -->
				<div id="main" style="margin-left: 22em;">
					<a name="Section1"></a>
					<article class="post">
						<header>
							<div class="title">
								<h2>設定K-fold</h2>
							</div>
						</header>
						<div class="article_code">
							<span class="comment_code"># Set up the trainControl object for 5-fold cross-validation</span><br/>
							ctrl <- trainControl(method = "cv", number = 5, savePredictions = "all", classProbs = TRUE)<br/>
						</div><br/>
					</article>
					<a name="Section2"></a>
					<article class="post">
						<header>
							<div class="title">
								<h2>建立訓練模組</h2>
							</div>
						</header>
						<ul>
							<li>Logistic regression</li>
							<li>K nearest neighbors</li>
							<li>SVC Linear</li>
							<li>SVC RBF</li>
							<li>Gaussian Naive Bayes</li>
							<li>Decision Tree</li>
							<li>Random Forest Classifier</li>
						</ul>
						<div class="article_code">
							if(model_name == "Logistic regression"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived ~ ., data = train_data, method = "glm", trControl = ctrl, family = "binomial")<br/>
							} else if(model_name == "K nearest neighbors"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived ~ ., data = train_data, method = "knn", trControl = ctrl, preProcess = c("center", "scale"),tuneLength = 3)<br/>
							} else if(model_name == "SVC Linear"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived ~ ., data = train_data, kernel = "svm", trControl = ctrl, scale = FALSE)<br/>
							} else if(model_name == "SVC RBF"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived ~ ., data = train_data, kernel = "radial", trControl = ctrl, scale = FALSE)<br/>
							} else if(model_name == "Gaussian Naive Bayes"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived ~ ., data = train_data, kernel = "naiveBayes", trControl = ctrl)<br/>
							} else if(model_name == "Decision Tree"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived~., data = train_data, method = 'rpart', trControl = ctrl)<br/>
							} else if(model_name == "Random Forest Classifier"){<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- train(Survived~., data = train_data, method = 'rf', trControl = ctrl)<br/>
							}<br/>
						</div><br/>
					</article>
					<a name="Section3"></a>
					<article class="post">
						<header>
							<div class="title">
								<h2>訓練結果</h2>
							</div>
						</header>
						<img src="images/model_01.png"><br/><br/>
					</article>

					<a name="Section4"></a>
					<article class="post">
						<header>
							<div class="title">
								<h2>預測測試集資料</h2>
							</div>
						</header>
						<div class="article_code">
							model_list <- c("Logistic regression","K nearest neighbors","SVC Linear","SVC RBF","Gaussian Naive Bayes","Decision Tree","Random Forest Classifier")<br/>

							for (model_name in model_list) {<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment_code"># Train the model</span><br/>
								&nbsp;&nbsp;&nbsp;&nbsp;Training_model <- TrainingModel(model_name, preprocess_train_data)<br/><br/>
							
								&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment_code"># Predict the outcomes for the test data</span><br/>
								&nbsp;&nbsp;&nbsp;&nbsp;res_predictions <- predict(Training_model, newdata = preprocess_test_data)<br/><br/>

								&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment_code"># Calculate the accuracy of the predictions</span><br/>
								&nbsp;&nbsp;&nbsp;&nbsp;res_accuracy <- sum(res_predictions == preprocess_test_data$Survived) / nrow(preprocess_test_data)<br/><br/>
							
								&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment_code"># Calculate the confusion matrix</span><br/>
								&nbsp;&nbsp;&nbsp;&nbsp;res_cm <- table(res_predictions,preprocess_test_data$Survived)<br/><br/>
							
								&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment_code">## Print the results</span><br/>
								&nbsp;&nbsp;&nbsp;&nbsp;cat("使用test data進行預測的準確率：", res_accuracy , '\n')<br/>
								&nbsp;&nbsp;&nbsp;&nbsp;print(res_cm)<br/>
							}
						</div><br/>
					</article>

					<a name="Section5"></a>
					<article class="post">
						<header>
							<div class="title">
								<h2>預測結果</h2>
							</div>
						</header>
						<img src="images/model_02.png"><br/><br/>
					</article>
					
					<a name="Section6"></a>
					<article class="post">
						<header>
							<div class="title">
								<h2>實際演練</h2>
							</div>
						</header>
						<article class="post">
							<header>
								<div class="title">
									<h2><a href="https://nccueric.shinyapps.io/demo2/" target="_blank">Demo</a></h2>
								</div>
							</header>
							<iframe 
							src="https://nccueric.shinyapps.io/demo2/"
							width="100%"
							height="640px"
							>
						</iframe>
						</article>
					</article>					
				</div>
				<!-- Sidebar -->
				<section id="sidebar" style="position: fixed;left: 6em;">
					<!-- Posts List -->
						<section>
							<ul class="posts">
								<li>
									<article><header><h3><a href="#Section1">利用K-fold進行訓練</a></h3></header></article>
								</li>
								<li>
									<article><header><h3><a href="#Section2">建立訓練模組</a></h3></header></article>
								</li>
								<li>
									<article><header><h3><a href="#Section3">訓練結果</a></h3></header></article>
								</li>
								<li>
									<article><header><h3><a href="#Section4">預測測試集資料</a></h3></header></article>
								</li>
								<li>
									<article><header><h3><a href="#Section5">預測結果</a></h3></header></article>
								</li>
								<li>
									<article><header><h3><a href="#Section6">實際演練</a></h3></header></article>
								</li>
							</ul>
						</section>
				</section>
			</div>

	</body>
</html>